<!DOCTYPE html>

<html lang="ru" dir="ltr">
  <head>

<link rel="stylesheet" type="text/css" href="style.css">
    <meta charset="utf-8">
    <title>Web implementation of chat with basic functional</title>
      <script src="data.js"  type="text/javascript">
      </script>
  </head>


    <caption>Chat client</caption>
  <body>
  <div id="autorisation">
      <div>
          <h2>Введите свое имя</h2>
          <input type="text" id="login">
          <br>
          <button type="button" name="button" class="btn" onclick="autoris()">Принять</button>
      </div>
  </div>

  <script>
      let TYPE = "AGENT";
      function checkAnswer() {
          let msgField = document.getElementById("messageField");
          let strMessage = msgField.value;
          try {
              if (strMessage && (strMessage[0] == "/")) {
                  let words = strMessage.split(" ")
                  if((currentUser == null) && (words.length = 2) && (words[0] == '/register')) {
                      currentUser = new User(words[1], "AGENT")
                      msg = new Message(currentUser, "", "reg")
                      showMessage(new Message(new User("Server"), "Hello, " + currentUser.name))
                      sendMessage(msg)
                  } else if (currentUser != null) {
                      if(words[0] == "/exit") {
                          msg = new Message(currentUser, "", "exit")
                          sendMessage(msg)
                      } else if(words[0] == "/skip") {
                          msg = new Message(currentUser, "", "skip")
                          sendMessage(msg)
                      }
                  }
              } else if (currentUser != null) {
                  msg = new Message(currentUser, strMessage)
                  console.log(msg)
                  sendMessage(msg)
                  showMessage(msg)
              }
          } catch(err) {
              console.log(err)
          }
          msgField.value = "";
      }
  </script>
 
      <input type="text" name="message" id="messageField">
      <input onclick="sendMessage()"type="submit" value="Отправить">
    

    <!-- здесь будут появляться входящие сообщения -->
    <div id="subscribe">MessageList</div>
      <script src="lol.js"  type="text/javascript">
      </script>
  </body>
</html>
